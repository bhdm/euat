{% extends 'AppBundle::layout.html.twig' %}

{% block javascript %}
    {{ parent() }}
    <script src="{{ asset('assets/vendor/moment/moment.js') }}"></script>
    <script src="{{ asset('assets/vendor/moment/locale/ru.js') }}"></script>
    <script src="{{ asset('assets/vendor/eonasdan-bootstrap-datetimepicker/build/js/bootstrap-datetimepicker.min.js') }}"></script>
{% endblock %}
{% block seo %}
    <title>
        {% if type == null %}
            События
        {% elseif type == 'congress' %}
            Конгрессы и Съезды
        {% elseif type == 'school' %}
            Школы
        {% elseif type == 'partner' %}
            Партнерские события
        {% endif %}
    </title>
{% endblock %}
{% block content %}
    <div class="col-xs-4" style="padding-left: 0; max-width: 250px;">
        {{ render(controller("AppBundle:Widget:calendar" )) }}
    </div>
    <div class="col-xs-8" style="padding-right: 0">

        <ol class="breadcrumb">
            <li><a href="{{ path('homepage') }}">Главная</a></li>
            <li class="active">
                {% if type == null %}
                    События
                {% elseif type == 'congress' %}
                    Конгрессы и Съезды
                {% elseif type == 'school' %}
                    Школы
                {% elseif type == 'partner' %}
                    Партнерские события
                {% endif %}
            </li>
        </ol>

        {% if type == null %}
            <h1 class="blue-text">События</h1>
        {% elseif type == 'congress' %}
            <h1 class="blue-text">Конгрессы и Съезды</h1>
        {% elseif type == 'school' %}
            <h1 class="blue-text">Школы</h1>
        {% elseif type == 'partner' %}
            <h1 class="blue-text">Партнерские события</h1>
        {% endif %}

        <div class="row">
            <form class="form-inline" method="GET" style="min-width: 695px">
                <div class="form-group">
                    <label style="font-weight: normal">С </label>
                    <input type="date" class="form-control" placeholder="Дата начала" style="width: 130px; font-size: 12px" name="start" value="{{ start }}">
                </div>
                <div class="form-group">
                    <label style="font-weight: normal"> по </label>
                    <input type="date" class="form-control" placeholder="Дата окончания" style="width: 130px; font-size: 12px" name="end" value="{{ end }}">
                </div>
                <div class="form-group">
                    <input type="text" class="form-control" placeholder="Фраза поиска" name="searchtext" value="{{ text }}" style="width: 210px; font-size: 12px">
                </div>
                <button class="btn btn-primary">Фильтр</button>
                <a href="{{ path('events',{'type' : type}) }}"><button type="button" class="btn btn-danger" style="padding: 6px 12px">&times;</button></a>
            </form>
        </div>

        <div>
            {% for p in events %}
                <div class="new-item">
                    <span style="padding-right: 20px; color: #888">
                        <span class="glyphicon glyphicon-calendar"></span>
                        {{ p.start | date('d.m.Y') }}{{ p.end != null ? ' - '~p.end | date('d.m.Y') : '' }}
                    </span>
                    <br />
                    <a href="{{ path('event', {'url' : p.id }) }}"><span class="new-item-title">{{ p.title }}</span></a>
                    <div class="new-item-anons">
                        {{ p.body | anons | raw }}
                        {% if p.category != null %}
                            <div style="color: #555">
                                {{ p.category.title }}
                            </div>
                        {% endif %}
                    </div>
                </div>
                {% for i in p.items %}
                    <div class="new-item">
                    <span style="padding-right: 20px; color: #888">
                        <span class="glyphicon glyphicon-calendar"></span>
                        {{ i.start | date('d.m.Y') }}{{ i.end != null ? ' - '~i.end | date('d.m.Y') : '' }}
                    </span>
                        <br />
                        <a href="{{ path('event', {'url' : p.id, 'number' : i.id }) }}"><span class="new-item-title">{{ p.title }}</span></a>
                        {% if is_granted('ROLE_ADMIN') %} <a href="{{ path('admin_event_edit',{'id' : p.id}) }}"><span class="glyphicon glyphicon-edit"></span></a>{% endif %}
                        <div class="new-item-anons">
                            {{ p.body | anons | raw }}
                            {% if p.category != null %}
                                <div style="color: #555">
                                    {{ p.category.title }}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            {% endfor %}
        </div>
    </div>
{% endblock %}